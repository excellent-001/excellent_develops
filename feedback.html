<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Project Feedback — Excellent Developers</title>
<style>
  :root {
    --accent1: #3b82f6;
    --accent2: #10b981;
    --accent3: #f59e0b;
    --accent4: #8b5cf6;
    --bg: #f3f4f6;
    --text: #111827;
    --card: #ffffffdd;
  }
  *{box-sizing:border-box;margin:0;padding:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial;}
  body{min-height:100vh;background:linear-gradient(135deg,#f3f4f6,#e5e7eb);color:var(--text);display:flex;flex-direction:column;}
  header{padding:20px;text-align:center;font-size:22px;font-weight:bold;}
  main{flex:1;display:flex;flex-direction:column;align-items:center;padding:20px;}
  .intro{max-width:800px;text-align:center;margin-bottom:30px;}
  .form-card{background:linear-gradient(135deg,var(--accent1),var(--accent2));padding:30px;border-radius:20px;max-width:500px;width:100%;box-shadow:0 10px 30px rgba(0,0,0,0.1);}
  .form-card h2{color:white;text-align:center;margin-bottom:20px;font-size:24px;}
  .form-card input, .form-card textarea{width:100%;padding:12px;border-radius:10px;border:none;margin-bottom:15px;font-size:16px;}
  .form-card textarea{resize:none;min-height:100px;}
  .form-card button{width:100%;padding:12px;background:#fff;color:#000;border:none;border-radius:10px;font-weight:bold;cursor:pointer;font-size:16px;}
  .success-popup{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%) scale(0);background:var(--accent2);color:white;padding:30px 40px;border-radius:20px;text-align:center;font-size:20px;font-weight:bold;z-index:1000;transition:0.3s;}
  .success-popup.show{transform:translate(-50%,-50%) scale(1);}
  .projects-header{font-size:28px;margin-bottom:20px;text-align:center;}
</style>
</head>
<body>
<header>Excellent Developers — Feedback</header>
<main>
  <div class="intro" id="projectIntro">
    <!-- Project intro will appear here -->
  </div>
  <div class="form-card">
    <h2>Share your Feedback</h2>
    <input type="text" id="fbName" placeholder="Your Name" required/>
    <input type="email" id="fbEmail" placeholder="Your Email" required/>
    <textarea id="fbMessage" placeholder="Your Feedback" required></textarea>
    <button id="fbSubmit">Send Feedback</button>
  </div>
</main>

<div class="success-popup" id="successPopup">✅ Your feedback has been sent!</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-app.js";
import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyDoTlLIlOyoYiTZLQmzVcDro-cw9TCU9qI",
  authDomain: "excellent-d056e.firebaseapp.com",
  projectId: "excellent-d056e",
  storageBucket: "excellent-d056e.firebasestorage.app",
  messagingSenderId: "629984941607",
  appId: "1:629984941607:web:3d7fc2478f555d45a0e002",
  measurementId: "G-G3RCTDSY27"
};
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

// Get project from URL
const params = new URLSearchParams(window.location.search);
const project = params.get('project') || 'Excellent Global Concept';

const projectIntro = document.getElementById('projectIntro');
const accentColors = {
  "Excellent Global Concept":"#3b82f6",
  "Pematech Company":"#10b981",
  "Social Intelligence Hub":"#f59e0b",
  "LMS Platform":"#8b5cf6"
};
const projectDescriptions = {
  "Excellent Global Concept":"Our main brand delivering excellence globally.",
  "Pematech Company":"Innovative tech and engineering solutions.",
  "Social Intelligence Hub":"Connecting social intelligence to real world problems.",
  "LMS Platform":"Educational platform providing high-quality learning."
};

// Set intro dynamically
projectIntro.innerHTML = `
  <h3>${project}</h3>
  <p>${projectDescriptions[project] || "Exciting project under development!"}</p>
  <p>We're working hard to bring this project to life. Please share your feedback below to help us improve it!</p>
`;

// Set gradient dynamically
const formCard = document.querySelector('.form-card');
formCard.style.background = `linear-gradient(135deg, ${accentColors[project] || '#3b82f6'}, #ffffff33)`;

// Elements
const fbName = document.getElementById('fbName');
const fbEmail = document.getElementById('fbEmail');
const fbMessage = document.getElementById('fbMessage');
const fbSubmit = document.getElementById('fbSubmit');
const successPopup = document.getElementById('successPopup');

// Function to get IP/ISP/Location
async function getUserInfo(){
  try{
    const res = await fetch('https://ipapi.co/json/');
    return await res.json();
  }catch{return {};}
}

// Submit feedback
fbSubmit.onclick = async ()=>{
  const name = fbName.value.trim();
  const email = fbEmail.value.trim();
  const message = fbMessage.value.trim();
  if(!name || !email || !message){ alert("Please fill all fields"); return; }

  fbSubmit.disabled = true;
  const info = await getUserInfo();
  try{
    await addDoc(collection(db,"feedbacks"),{
      project,name,email,message,ip:info.ip||'',city:info.city||'',region:info.region||'',country:info.country_name||'',isp:info.org||'',createdAt:serverTimestamp()
    });

    // Optional: Send email via MailJS here (configure your MailJS)
    // await sendMailJS({project,name,email,message});

    successPopup.classList.add('show');
    setTimeout(()=>successPopup.classList.remove('show'),2500);

    fbName.value=''; fbEmail.value=''; fbMessage.value='';
  }catch(e){
    alert("Error submitting feedback: "+e);
  }
  fbSubmit.disabled = false;
};
</script>
</body>
</html>
